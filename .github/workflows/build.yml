name: Build

on:
  push:
    branches: [ write ]

  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Install libcurl on Linux
      if: runner.os == 'Linux'
      run: sudo apt-get update -y && sudo apt-get install -y libcurl4-openssl-dev
    - name: Checkout repo
      uses: actions/checkout@v2
      with:
        submodules: recursive
    - uses: r-lib/actions/setup-r@v2
      with:
        r-version: '4.0.2'
    - name: Install renv and R dependencies
      uses: r-lib/actions/setup-renv@v2
      with:
        cache-version: 2
    - name: Install Hugo
      run: Rscript -e 'blogdown::install_hugo()'
    - name: Build website
      run: Rscript -e 'blogdown::build_site()'
